# Pokémon Sleep イベント登録ガイドライン

## 指示の検出条件

以下のような指示を受け取った場合、新しいイベントを登録する処理を実行する：
- 「新しいイベントを登録」「イベントを追加」「このニュースを登録」などのキーワード
- URLが含まれる場合（特に `pokemonsleep.net/news/` を含むURL）

## 処理手順

### 1. ニュースページの取得
- ニュース一覧URL（`https://www.pokemonsleep.net/news/`）を開く、または指定された詳細ページURLを開く
- Web検索（web_searchツール）を使用してページコンテンツを取得
- **注意**: ページネーションは不要（1ページ目のみで十分）

### 2. イベント情報の抽出
ニュース詳細ページから以下を取得：
- **タイトル**: `<title>`タグまたは記事見出しから抽出（「【新登場】」パターンに注意）
- **開催期間**: 「開催期間」「・X/X(曜日) 4:00～Y/Y(曜日) 3:59」などのパターンを検索
- **説明文**: 記事本文から主要な情報を抽出（概要、ボーナス、ピックアップ情報など）
- **URL**: 現在のページURLを記録
- **ヘッダー画像**: ページのヘッダー画像を取得して色味を抽出（主要な色を分析）

### 3. 重複チェック（重要）
- 既存のすべてのイベントファイル（`data/events.json`, `data/events_new_pokemon.json`, `data/events_nmd.json`, `data/events_gsd.json`）を確認
- 同じURLまたは同じタイトルが既に登録されている場合は、**登録をスキップ**（登録不要）

### 4. イベントタイプの判定
タイトルまたは説明文から判定：
- タイトルが「【新登場】」で始まる → `data/events_new_pokemon.json`
- 「新ポケモン」「新ポケ」「新たに出会えるポケモン」を含む → `data/events_new_pokemon.json`
- 「新フィールド」「新島」を含む → `data/events_new_pokemon.json`（フィールド情報も含む場合）
- 「ニュームーンデー」「新月」「ダークライ」を含む場合 → **基本的に無視**（NMDはプレイヤー名で公式では使われず、2026年まで自動登録済み）
- 「グッドスリープデー」「満月」を含む場合 → **基本的に無視**（GSDはプレイヤー名で公式では使われず、2026年まで自動登録済み）
- その他 → `data/events.json`

### 5. イベントデータの生成ルール
- `id`: タイトルから生成（ローマ字化、小文字、スペース/記号をアンダースコアに変換、既存IDとの重複を避ける）
- `title`: 取得したタイトルをそのまま使用
- `start`: 開催期間から開始日を抽出（YYYY-MM-DD形式）
- `end`: 開催期間から終了日を抽出（YYYY-MM-DD形式、終了時刻が3:59の場合は前日を終了日とする）
- `allDay`: デフォルトは`true`（時刻が明示的に指定されている場合は`false`）
- `description`: 取得した説明文を整形（改行は`\n`で表現、既存イベントのフォーマットを参考）
- `link`: 取得したURL
- `tags`: タイトルと説明から自動判定（**既存のtagsパターンをまとめて参考にし、なるべく類似タグを使用。新しい場合は作成してよい**）
- `color`: **ニュースページのヘッダー画像から主要な色味を抽出して設定**（画像がない場合はイベントタイプに応じたデフォルト色）

### 6. JSONファイルへの追加
- 判定されたファイルを読み込み（read_fileツールを使用）
- 新規イベントを配列に追加（適切な位置に挿入、日付順を考慮）
- JSON構文を確認して保存（writeツールまたはsearch_replaceツールを使用）

## 既存タグパターン参考

### events.json
["イベント", "キャンペーン", "ハロウィン", "バレンタイン", "記念日", "ピックアップ", "タイプ名（でんきタイプ、ほのおタイプ、みずタイプ、ゴーストタイプ、エスパータイプ、くさタイプ、フェアリータイプなど）", "記念", "フェスティバル", "サマーフェスティバル", "スプリングフェス", "ホリデー", "新年", "2025年", "ゆめのかけら", "ダブル", "料理", "デカ盛り料理ウィーク", "食材", "スキル", "ミニアメブースト", "成長", "ポケモンすくすくウィーク", "vol.1", "vol.2"など, "リリース", "配信開始", "新フィールド", "フィールド追加", "アップデート", "メンテナンス", "Ver.X.X.X", "バランス調整"]

### events_new_pokemon.json
["イベント", "新ポケモン", "新フィールド", ポケモン名（例："バケッチャ", "パンプジン", "クチート"など）, "特別なポケモン", "伝説", "ホウエン地方", "パルデア地方", "アローラのすがた", "パルデアのすがた"]

## 日付変換ルール
- 「X/X(曜日) 4:00」形式 → YYYY-MM-DD形式に変換（年は現在の年または記事の公開年を推測）
- 「X月X日」形式 → YYYY-MM-DD形式に変換
- 「X/X ～ Y/Y」形式 → start と end を設定
- 「3:59」で終わる場合は、その日の前日をendとして設定（例：11/4(月) 3:59 → end: "2025-11-03"）

## 重要な注意事項
- **重複チェックが必須**: 既存イベントとの重複をチェック（同じURLまたはタイトルが既に存在しないか）。重複している場合は登録をスキップ
- **ページネーション不要**: ニュース一覧から直接詳細ページにアクセス、ページネーションは不要
- **NMD/GSDの扱い**: NMDとGSDはプレイヤーが考えた名前で公式では使われないため、タイトルや説明から判定する場合は「ニュームーンデー」「グッドスリープデー」の文字列で判断し、基本的に無視
- **タグの使用**: 既存のtagsパターンを参考にし、類似タグを使用。新しい場合は作成可能
- **色の抽出**: ヘッダー画像から色味を抽出（画像がない場合はデフォルト色）
- **新登場パターン**: タイトルが「【新登場】」で始まる場合は新ポケモン/フィールド追加と判断
- JSONファイルの構文エラーに注意（配列の最後にカンマが残っていないか）
